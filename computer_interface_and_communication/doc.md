# 实验方案设计

- 8259A初始化

    - 主片：  
      ICW1:00010001B(11H)[偶]  
      ICW2:00001000B(08H)[奇]  
      ICW3:00100100B(24H)[奇]  
      ICW4:00000001B(01H)[奇]  

    - 从片(IR2)：  
      ICW1:00010001B(11H)[偶]  
      ICW2:01110000B(70H)[奇]  
      ICW3:00000010B(02H)[奇]  
      ICW4:00000001B(01H)[奇]  

    - 从片(IR5)：  
      ICW1:00010001B(11H)[偶]  
      ICW2:10010000B(90H)[奇]  
      ICW3:00000101B(05H)[奇]  
      ICW4:00000001B(01H)[奇]  

- 利用8255A传输数据

    `PC7`充当选通信号(`STB`)，通过`PC7`的置位/复位产生选通信号(`STB`)。同时，使用`PC2`接收`IBF`信号查询能否输出。    
    - 控制字   ：10000001B(81H)
    - `PC7`置位：00001111B(0FH)
    - `PC7`复位：00001110B(0EH)
    - 通过连续两个`NOP`指令实现`STB`信号延迟300ns

- 利用8253产生周期等于20秒的方波
    
    计数值：N = T<sub>OUT</sub> / T<sub>CLK</sub> = ƒ<sub>CLK</sub> * T<sub>OUT</sub> = 2 * 10<sup>6</sup> * 20 = 4 * 10<sup>7</sup> > 65536

    已经超出一个通道的计数能力，因此采用两个通道串联，其中一个作为分频器(工作方式2)，另一个产生方波(工作方式3)。

    假设T<sub>0</sub>初值N<sub>0</sub>，T<sub>1</sub>初值N<sub>1</sub>：
    T<sub>OUT1</sub> = N<sub>1</sub> * T<sub>CLK1</sub> 
                     = N<sub>1</sub> * T<sub>OUT0</sub> 
                     = N<sub>1</sub> * N<sub>0</sub> * T<sub>CLK0</sub> 
                     = N<sub>1</sub> * N<sub>0</sub> / ƒ<sub>CLK0</sub>

    故
    N<sub>0</sub> * N<sub>1</sub> = 4 * 10<sup>7</sup>
    (N<sub>0</sub>和N<sub>1</sub>均不大于65536)

    - N<sub>0</sub>: 20000  
    - N<sub>1</sub>: 2000
    - T<sub>0</sub>工作方式2方式控制字:00110100B(34H)
    - T<sub>1</sub>工作方式3方式控制字:01110110B(76H)

- 利用8251实现数据传输

    - 工作命令字：01000000B(40H)
    - 方式命令字：11111010B(FAH)
    - 工作命令字：00110111B(37H)
    